(this["webpackJsonpreact_redux-list-of-posts"]=this["webpackJsonpreact_redux-list-of-posts"]||[]).push([[0],{20:function(t,e,n){t.exports={post:"PostListItem_post__30y8A",postTitle:"PostListItem_postTitle__3WN76",postBody:"PostListItem_postBody___BpLF"}},26:function(t,e,n){t.exports={auth:"Auth_auth__3lCWp",auth__left:"Auth_auth__left__2vh-z"}},31:function(t,e,n){t.exports={wrapperSpinner:"Loader_wrapperSpinner__3y503"}},52:function(t,e,n){},53:function(t,e,n){"use strict";n.r(e);var s,r=n(12),c=n.n(r),a=n(8),o=n(17),i=n(0),u=n(3),l=n(2),j=n(13),b=n(6),d=n.n(b);!function(t){t.SET_AUTH="SET_AUTH",t.SET_ERROR="SET_ERROR",t.SET_USER="SER_USER",t.SET_IS_LOADING="SET_IS_LOADING"}(s||(s={}));var O,p={isAuth:!1,user:{},isLoading:!1,error:""},h={setUser:function(t){return{type:s.SET_USER,payload:t}},setIsAuth:function(t){return{type:s.SET_AUTH,payload:t}},setIsLoading:function(t){return{type:s.SET_IS_LOADING,payload:t}},setError:function(t){return{type:s.SET_ERROR,payload:t}},login:function(t,e){return function(){var n=Object(j.a)(d.a.mark((function n(s){return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{s(h.setIsLoading(!0)),setTimeout(Object(j.a)(d.a.mark((function n(){var r,c,a;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("./users.json");case 2:return r=n.sent,n.next=5,r.json();case 5:c=n.sent,(a=c.find((function(n){return n.username===t&&n.password===e})))?(localStorage.setItem("auth","true"),localStorage.setItem("username",a.username),s(h.setIsAuth(!0)),s(h.setUser(a))):s(h.setError("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 Email \u0438\u043b\u0438 password")),s(h.setIsLoading(!1));case 9:case"end":return n.stop()}}),n)}))),1e3)}catch(r){s(h.setError("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"))}case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()},logout:function(){return function(){var t=Object(j.a)(d.a.mark((function t(e){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.removeItem("auth"),localStorage.removeItem("username"),e(h.setUser({})),e(h.setIsAuth(!1));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},m=n(1),f=function(){return Object(m.jsx)(o.b,{to:"/",className:"logo",children:"#1"})},x=[{label:"Posts",path:"/posts"}],_=function(){var t=Object(a.b)();return Object(m.jsxs)("div",{className:"layout__navbar",children:[Object(m.jsx)(f,{}),Object(m.jsx)("ul",{className:"navbar-list",children:x.map((function(t){return Object(m.jsx)("li",{className:"navbar-list__item",children:Object(m.jsx)(o.c,{to:t.path,className:function(t){return t.isActive?"navbar-list__link navbar-list__link--active":"navbar-list__link"},children:t.label})},t.label)}))}),Object(m.jsx)("button",{type:"button",onClick:function(){t(h.logout())},className:"btn btn-light ms-3",children:"Logout"})]})},S=function(){return Object(m.jsxs)("div",{className:"layout",children:[Object(m.jsx)(_,{}),Object(m.jsx)("div",{className:"layout__content",children:Object(m.jsx)(u.b,{})})]})},E=function(){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h1",{className:"mb-3",children:"Home Page"}),Object(m.jsx)("h5",{children:' \u2190 Click on the "posts" in the menu'})]})},T=n(55),v=n(31),y=n.n(v),g=function(){return Object(m.jsx)("div",{className:y.a.wrapperSpinner,children:Object(m.jsx)(T.a,{animation:"grow"})})},N=n(4),P=n(24),C="https://mate.academy/students-api",w=function(){var t=Object(j.a)(d.a.mark((function t(e){var n,s,r,c=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{method:"GET"},t.prev=1,t.next=4,fetch("".concat(C).concat(e),n);case 4:return s=t.sent,t.next=7,s.json();case 7:if(r=t.sent,s.ok){t.next=10;break}throw new Error("Error with request");case 10:return t.abrupt("return",r);case 13:return t.prev=13,t.t0=t.catch(1),console.log(t.t0),t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}(),I=function(){return w("/posts")},L=function(t){return w("/posts/".concat(t))},k=function(t){return w("/comments").then((function(e){return e.filter((function(e){return e.postId===t}))}))},M=function(t){return w("/comments",{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(t)})},A=function(t){return w("/comments/".concat(t),{method:"DELETE"})};!function(t){t.FETCH_POSTS_LOADING="FETCH_POSTS_LOADING",t.SET_POSTS="SET_POSTS",t.FETCH_POSTS_ERROR="FETCH_POSTS_ERROR",t.SET_DETAILS_POST="SET_DETAILS_POST",t.FETCH_DETAILS_POST="FETCH_DETAILS_POST",t.SET_COMMENTS_POST="SET_COMMENTS_POST",t.FETCH_COMMENTS_POST="FETCH_COMMENTS_POST",t.SEND_COMMENT="SEND_COMMENT",t.SET_NEW_COMMENT="SET_NEW_COMMENT",t.DELETE_COMMENT="DELETE_COMMENT"}(O||(O={}));var D={posts:[],loadingPosts:!1,errorPosts:null,postDetails:null,commentsPost:[]},R={setPosts:function(t){return{type:O.SET_POSTS,payload:t}},fetchPosts:function(){return function(){var t=Object(j.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(R.fetchPostsLoading()),t.next=4,I();case 4:n=t.sent,e(R.setPosts(n)),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),"\u041f\u0440\u043e\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u0430\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u043e\u0441\u0442\u043e\u0432. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435!",e(R.fetchErrorPosts("\u041f\u0440\u043e\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u0430\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u043e\u0441\u0442\u043e\u0432. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435!")),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},fetchErrorPosts:function(t){return{type:O.FETCH_POSTS_ERROR,payload:t}},fetchPostsLoading:function(){return{type:O.FETCH_POSTS_LOADING}},SetDetailsPost:function(t){return{type:O.SET_DETAILS_POST,payload:t}},fetchDetailsPost:function(t){return function(){var e=Object(j.a)(d.a.mark((function e(n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L(t);case 3:s=e.sent,n(R.SetDetailsPost(s)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},setCommentsPost:function(t){return{type:O.SET_COMMENTS_POST,payload:t}},fetchCommentsPost:function(t){return function(){var e=Object(j.a)(d.a.mark((function e(n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k(t);case 3:s=e.sent,n(R.setCommentsPost(s)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},setNewComment:function(t){return{type:O.SET_NEW_COMMENT,payload:t}},sendComments:function(t){return function(){var e=Object(j.a)(d.a.mark((function e(n){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t);case 2:s=e.sent,n(R.setNewComment(s));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},deleteComment:function(t){return{type:O.DELETE_COMMENT,payload:t}},deleteFetchComment:function(t){return function(){var e=Object(j.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:n(R.deleteComment(t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},F=a.c,H=n(5),U=n.n(H),B=function(t){var e=t.postId,n=Object(i.useState)(""),s=Object(N.a)(n,2),r=s[0],c=s[1],o=Object(i.useState)(!1),u=Object(N.a)(o,2),l=u[0],j=u[1],b=F((function(t){return t.auth})).user,d=Object(a.b)();return Object(m.jsx)("form",{className:"test",onSubmit:function(t){if(t.preventDefault(),0!==r.length){var n={email:b.username,name:b.username,body:r,postId:e};d(R.sendComments(n)),c("")}else j(!0)},children:Object(m.jsxs)("div",{className:"form-floating",children:[Object(m.jsx)("textarea",{className:U()("form-control mb-3",{"is-invalid":l}),placeholder:"Leave a comment here",id:"floatingTextarea",style:{height:"100px"},value:r,onChange:function(t){return c(t.target.value)},onBlur:function(){return j(!1)}}),Object(m.jsx)("label",{htmlFor:"floatingTextarea",children:"Add Comments"}),Object(m.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:"Send"})]})})},G=n(56),W=function(t){var e=t.show,n=t.handleClose,s=t.backdrop,r=t.keyboard,c=t.size,a=t.title,o=t.children;return Object(m.jsxs)(G.a,{show:e,onHide:n,backdrop:s,keyboard:r,size:c,children:[Object(m.jsx)(G.a.Header,{closeButton:!0,children:Object(m.jsx)(G.a.Title,{children:a})}),Object(m.jsx)(G.a.Body,{children:o})]})};W.defaultProps={backdrop:!0,keyboard:!0,size:"lg"};var z=function(t){var e=t.show,n=t.handleClose,s=Object(i.useState)(!0),r=Object(N.a)(s,2),c=r[0],o=r[1],u=F((function(t){return t.posts})),l=u.postDetails,j=u.commentsPost,b=Object(a.b)();return Object(m.jsx)(W,{show:e,handleClose:n,title:"Posts details",children:Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("p",{children:null===l||void 0===l?void 0:l.body}),Object(m.jsx)("hr",{}),Boolean(j.length)&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:[Object(m.jsx)("h4",{className:"mb-0",children:"Comments:"}),Object(m.jsx)("button",{type:"button",className:"btn btn-outline-dark",onClick:function(){return o(!c)},children:c?"Hide":"Show"})]}),c&&Object(m.jsx)("ul",{children:j.map((function(t){return Object(m.jsxs)("li",{className:"d-flex align-items-center justify-content-between mb-2",children:[Object(m.jsx)("span",{className:"text-break pr-3",children:t.body}),Object(m.jsx)("button",{type:"button",className:"btn btn-warning",onClick:function(){return e=t.id,void b(R.deleteFetchComment(e));var e},children:"X"})]},t.id)}))}),Object(m.jsx)("hr",{})]}),Object(m.jsx)(B,{postId:null===l||void 0===l?void 0:l.id})]})})},J=n(39),q=n(20),X=n.n(q),K=function(t){var e=t.post,n=t.handleShowModal;return Object(m.jsxs)("li",{className:X.a.post,children:[Object(m.jsxs)("div",{className:X.a.post__left,children:[Object(m.jsx)("div",{className:X.a.postTitle,children:e.title}),Object(m.jsx)("p",{className:X.a.postBody,children:e.body})]}),Object(m.jsx)("div",{className:X.a.post__right,children:Object(m.jsx)(J.a,{variant:"outline-dark",onClick:function(){return n(e.id)},children:"Open"})})]})},Q=function(t){var e=t.posts,n=Object(a.b)(),s=Object(i.useState)(!1),r=Object(N.a)(s,2),c=r[0],o=r[1],u=Object(i.useCallback)((function(){o(!1)}),[c]),l=Object(i.useCallback)((function(t){n(R.fetchDetailsPost(t)),n(R.fetchCommentsPost(t)),o(!0)}),[]);return Object(m.jsxs)("div",{className:"wrapper",children:[e.length>0?Object(m.jsx)("ul",{children:e.map((function(t){return Object(m.jsx)(K,{post:t,handleShowModal:l},t.id)}))}):Object(m.jsx)("h3",{children:"Posts not found"}),Object(m.jsx)(z,{show:c,handleClose:u})]})},V=function(){var t=F((function(t){return t.posts})),e=t.posts,n=t.loadingPosts,s=t.errorPosts,r=Object(a.b)();return Object(i.useEffect)((function(){r(R.fetchPosts())}),[]),s?Object(m.jsx)("h3",{children:s}):n?Object(m.jsx)(g,{}):Object(m.jsx)(Q,{posts:e})},Y=function(){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h1",{children:"Posts Page"}),Object(m.jsx)(V,{})]})},Z=n(26),$=n.n(Z),tt=function(){return Object(m.jsxs)("div",{className:$.a.auth,children:[Object(m.jsx)("div",{className:$.a.auth__left}),Object(m.jsx)("div",{className:$.a.auth__right,children:Object(m.jsx)(u.b,{})})]})},et=function(){var t=Object(i.useState)("user"),e=Object(N.a)(t,2),n=e[0],s=e[1],r=Object(i.useState)("123"),c=Object(N.a)(r,2),o=c[0],u=c[1],l=Object(a.b)(),j=F((function(t){return t.auth})),b=j.error,d=j.isLoading;return Object(m.jsx)("div",{className:"FormLoginWrapper",children:Object(m.jsxs)("form",{autoComplete:"off",onSubmit:function(t){t.preventDefault(),l(h.login(n,o))},children:[b&&Object(m.jsx)("div",{style:{color:"red"},children:b}),Object(m.jsx)("div",{className:"mb-3",children:Object(m.jsxs)("label",{htmlFor:"email",className:"form-label",children:["Email address",Object(m.jsx)("input",{type:"text",className:"form-control",id:"email",value:n,onChange:function(t){return s(t.target.value)}})]})}),Object(m.jsx)("div",{className:"mb-3",children:Object(m.jsxs)("label",{htmlFor:"password",className:"form-label",children:["Password",Object(m.jsx)("input",{type:"password",className:"form-control",id:"password",value:o,onChange:function(t){return u(t.target.value)},autoComplete:"off"})]})}),Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:d,children:d?"Loading...":"Submit"})]})})},nt=function(){return Object(m.jsx)(et,{})},st=function(){return Object(m.jsx)(nt,{})},rt=(n(52),function(){var t=F((function(t){return t.auth})).isAuth,e=Object(a.b)();return Object(i.useEffect)((function(){localStorage.getItem("auth")&&(e(h.setUser({username:localStorage.getItem("username")})),e(h.setIsAuth(!0)))}),[]),Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(u.e,{children:t?Object(m.jsxs)(u.c,{path:"/",element:Object(m.jsx)(S,{}),children:[Object(m.jsx)(u.c,{path:"posts",element:Object(m.jsx)(Y,{})}),Object(m.jsx)(u.c,{index:!0,element:Object(m.jsx)(E,{})}),Object(m.jsx)(u.c,{path:"login",element:Object(m.jsx)(u.a,{to:"/"})})]}):Object(m.jsxs)(u.c,{path:"/*",element:Object(m.jsx)(tt,{}),children:[Object(m.jsx)(u.c,{path:"login",element:Object(m.jsx)(st,{})}),Object(m.jsx)(u.c,{path:"*",element:Object(m.jsx)(u.a,{to:"/login"})})]})})})}),ct=n(22),at=n(37),ot=n(38),it=Object(ct.combineReducers)({posts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case O.SET_POSTS:return Object(l.a)(Object(l.a)({},t),{},{loadingPosts:!1,posts:e.payload});case O.FETCH_POSTS_LOADING:return Object(l.a)(Object(l.a)({},t),{},{loadingPosts:!0});case O.FETCH_POSTS_ERROR:return Object(l.a)(Object(l.a)({},t),{},{loadingPosts:!1,errorPosts:e.payload});case O.SET_DETAILS_POST:return Object(l.a)(Object(l.a)({},t),{},{postDetails:e.payload});case O.SET_COMMENTS_POST:return Object(l.a)(Object(l.a)({},t),{},{commentsPost:e.payload});case O.SET_NEW_COMMENT:return Object(l.a)(Object(l.a)({},t),{},{commentsPost:[].concat(Object(P.a)(t.commentsPost),[e.payload])});case O.DELETE_COMMENT:return Object(l.a)(Object(l.a)({},t),{},{commentsPost:t.commentsPost.filter((function(t){return t.id!==e.payload}))});default:return t}},auth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case s.SET_AUTH:return Object(l.a)(Object(l.a)({},t),{},{isAuth:e.payload,isLoading:!1});case s.SET_USER:return Object(l.a)(Object(l.a)({},t),{},{user:e.payload});case s.SET_ERROR:return Object(l.a)(Object(l.a)({},t),{},{error:e.payload,isLoading:!1});case s.SET_IS_LOADING:return Object(l.a)(Object(l.a)({},t),{},{isLoading:e.payload});default:return t}}}),ut=Object(ct.createStore)(it,Object(at.composeWithDevTools)(Object(ct.applyMiddleware)(ot.a))),lt=function(){return Object(m.jsx)(a.a,{store:ut,children:Object(m.jsx)(o.a,{children:Object(m.jsx)(rt,{})})})};c.a.render(Object(m.jsx)(lt,{}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.c6ab4799.chunk.js.map